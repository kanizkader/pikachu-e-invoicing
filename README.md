[![codecov](https://codecov.io/github/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api/branch/main/graph/badge.svg?token=71FFT0HLKQ)](https://codecov.io/github/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api)

# WELCOME TO PIKACHU E-INVOICING!

#### Table of Contents
- [Website Link](https://github.com/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api#website-link)
- [Swagger](https://github.com/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api#swagger)
- [Features](https://github.com/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api#features)
- [Documentation](https://github.com/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api#documentation)
- [Examples](https://github.com/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api#examples)
- [Run Backend](https://github.com/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api#run-backend)
- [Run Frontend](https://github.com/cseteaching-unsw-edu-au/se2021-23t1-einvoicing-api-f10a-pikachu-rendering-api#run-frontend)

## Website
Sprint3Backend-env.eba-xjppryyv.us-east-1.elasticbeanstalk.com/homepage

## Swagger
https://app.swaggerhub.com/apis/BB81GNATHAN_1/F10A_PIKACHU/1.0.0

## Features

* Conversion of XML e-Invoice in UBL 2.0 format to HTML or JSON
* Support for both server side and client side rendering
* Support for 7 languages, including German, English, Spanish, French, Hindi, Russian and Chinese
* Three styled templates 
* Error handling for invalid parameters

## Documentation

| Route Name                           | Decription                                                                                                           | Parameters and Return Values                                                                                                                                       | HTTP Method | Exceptional Flows                                                                                                      |
|--------------------------------------|----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|------------------------------------------------------------------------------------------------------------------------|
| /invoice/render/html<br>/render/html | Generates a prerendered <br>HTML file with attached <br>CSS style page for the user <br>to view<br>on their browser. | Input: An XML file conforming <br>to UBL specifications,<br>a language and template specifier.<br>Output: Contains an HTML file and <br>a success code.            | POST        | 200 - Success<br>400 - Invalid template<br>400 - Invalid language<br>400 - Malformed XML<br>500 - Other internal error |
| /invoice/render/json<br>/render/json | Generates a JSON object <br>for client side rendering.                                                               | Input: An XML file conforming <br>to UBL 2.0 specs.<br>Output: A flattened JSON object <br>with keys generated by<br>concatenating keys and their <br>parent keys. | POST        | 200 - Success<br>400 - Malformed XML<br>500 - Other internal error                                                     |
| /invoice/render/pdf<br>/render/pdf   | Generates a PDF response for <br>the user to download.                                                               | Input: An XML file conforming to UBL<br>specifications, <br>a language and template specifier.<br>Output: A PDF file and a <br>success code.                       | POST        | 200 - Success<br>400 - Invalid template<br>400 - Invalid language<br>400 - Malformed XML<br>500 - Other internal error |
| /login                               | Logs a user in and returns a <br>token to be used in other routes.                                                   | Input: An email and password<br>Output: A token                                                                                                                    | POST        | 200 - Success<br>400 - Invalid email or password<br>400 - Duplicate login<br>500 - Other internal error                |
| /register                            | Registers a user with an associated<br>email and password. Does not return <br>a token.                              | Input: An email and password<br>Output: None                                                                                                                       | POST        | 200 - Success<br>400 - Invalid email<br>400 - Email already registered<br>500 - Other internal error                   |
| /logout                              | Given a token, invalidates the token<br>and logs a user out.                                                         | Input: A token<br>Output: None                                                                                                                                     | POST        | 200 - Success<br>500 - Other internal error                                                                            |
| /clear                               | Resets the user database to be empty.                                                                                | Input: None<br>Output: None                                                                                                                                        | DELETE      | 200 - Success<br>500 - Other internal error                                                                            |
## Examples

Example API call to generate a pre rendered HTML file using python, the requests library
and an XML file named example.xml stored in the working directory.
```
import requests

with open('example.xml') as file:
    xml_data = file.read()
params = {
    'language': 'en',
    'template': 'default'
}
headers = {'Content-Type': 'xml'}
requests.post('.../invoice/render/html', data = xml_data, params = params, headers = headers)
```

## Run Backend 
Run `pip install -r requirements.txt` in `backend` folder to install all necessary requirements. Then run `coverage run -m src.app` to start the server. 

## Run Frontend
Run `npm install` in  `frontend` folder to install all necessary requirements. Then run `npm start` to get the server started.
